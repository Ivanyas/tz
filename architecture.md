# Архитектура Email Outreach на 1200 ящиков

## Как устроено

Три слоя:

**Управление** — один VPS с API (NestJS), планировщиком задач (Bull + Redis) и простым дашбордом. Тут хранятся кампании, шаблоны, статистика.

**Воркеры** — 2-3 VPS которые берут задачи из очереди и отправляют письма. Каждый воркер работает с пулом ящиков.

**Провайдеры** — сами email-аккаунты. Разбиваю на три группы:
- Google Workspace — 400 ящиков
- Microsoft 365 — 400 ящиков
- Свой SMTP (Mailgun или подобное) — 400 ящиков

Если Google начнёт банить — остаётся 800 ящиков на других провайдерах.

## Лимиты и ротация

У Google лимит 500 писем в день на ящик, у Microsoft больше до 10к. Но чтобы не попасть в спам, отправляю 20-50 писем с ящика в день. Между письмами пауза 2-5 минут, имитируем живого человека.

Новые ящики прогреваю постепенно: первую неделю 10 писем/день, потом 20, потом 50. Если bounce rate выше 5% — ящик уходит на паузу.

При 1200 ящиках и 30 письмах с каждого получается примерно 36к писем в день.

## Мониторинг

Слежу за:
- bounce rate по каждому ящику и домену
- жалобы на спам (любая жалоба = сразу пауза)
- open rate и reply rate по кампаниям
- очередь задач (если растёт — добавить воркер)

Grafana для дашбордов, алерты в телеграм. Если что-то критичное, PagerDuty разбудит ночью.

## Риски

Главный риск — попасть в спам или получить бан от провайдера. Закрываю через:
- прогрев новых ящиков
- настроенные DKIM/SPF/DMARC
- мониторинг репутации
- быстрое переключение на другого провайдера

## Стоимость

Примерный расчёт в месяц:
- Google Workspace 400 ящиков по $6 = $2400
- Microsoft 365 400 ящиков по $6 = $2400
- SMTP сервис = ~$400
- VPS 3 штуки = $60
- Домены (20 штук) = $15-20

Итого около $5300/мес на полную инфраструктуру.

Для MVP можно начать с одного провайдера и 400 ящиков — это примерно $1800-1900/мес.

## Масштабирование

Если вырастем до 5000+ ящиков — переедем на Kubernetes, добавим отдельные IP-пулы для разных клиентов.
